import{G as e,j as s}from"./index-cd94da5a.js";import{r as a}from"./vendor-d6555781.js";import{t as r,p as t,u as l,r as n,m as d}from"./ui-eef567c7.js";import"./firebase-fb364782.js";import"./i18n-8b62e3c8.js";const Geofencing=()=>{const{guestData:i,setGuestData:c}=a.useContext(e),[m,g]=a.useState({name:"",lat:"",lng:"",radius:300}),[o,x]=a.useState(null),u=a.useMemo(()=>i.geofences||[],[i.geofences]),p=a.useMemo(()=>(i.geofenceLogs||[]).slice().reverse(),[i.geofenceLogs]);return s.jsx("div",{className:"max-w-3xl mx-auto p-6",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h1",{className:"text-2xl font-bold flex items-center",children:[s.jsx(r,{className:"h-6 w-6 mr-2"}),"Geofencing"]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("input",{className:"w-full p-2 rounded bg-gray-50 dark:bg-gray-700",placeholder:"Name",value:m.name,onChange:e=>g({...m,name:e.target.value})}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx("input",{className:"w-full p-2 rounded bg-gray-50 dark:bg-gray-700",placeholder:"Latitude",value:m.lat,onChange:e=>g({...m,lat:e.target.value})}),s.jsx("input",{className:"w-full p-2 rounded bg-gray-50 dark:bg-gray-700",placeholder:"Longitude",value:m.lng,onChange:e=>g({...m,lng:e.target.value})})]}),s.jsx("input",{className:"w-full p-2 rounded bg-gray-50 dark:bg-gray-700",placeholder:"Radius (m)",type:"number",value:m.radius,onChange:e=>g({...m,radius:e.target.value})}),s.jsxs("button",{onClick:()=>{if(!(m.name&&m.lat&&m.lng&&m.radius))return;const e=o||Math.random().toString(36).slice(2,10),s={id:e,...m,lat:parseFloat(m.lat),lng:parseFloat(m.lng),radius:parseFloat(m.radius)},a=o?u.map(a=>a.id===e?s:a):[s,...u];c(e=>({...e,geofences:a})),g({name:"",lat:"",lng:"",radius:300}),x(null)},className:"px-3 py-2 bg-primary-600 text-white rounded flex items-center",children:[s.jsx(t,{className:"h-4 w-4 mr-1"}),o?"Update Fence":"Add Fence"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold mb-2",children:"Fences"}),s.jsxs("ul",{className:"space-y-2",children:[u.map(e=>s.jsxs("li",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:e.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:["lat ",e.lat,", lng ",e.lng," — ",e.radius,"m"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>(e=>{g({name:e.name,lat:String(e.lat),lng:String(e.lng),radius:e.radius}),x(e.id)})(e),className:"px-2 py-1 bg-gray-200 dark:bg-gray-600 rounded text-sm flex items-center",children:[s.jsx(l,{className:"h-4 w-4 mr-1"}),"Edit"]}),s.jsxs("button",{onClick:()=>{return s=e.id,void c(e=>({...e,geofences:u.filter(e=>e.id!==s)}));var s},className:"px-2 py-1 bg-red-600 text-white rounded text-sm flex items-center",children:[s.jsx(n,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]},e.id)),0===u.length&&s.jsx("li",{className:"text-gray-500",children:"No geofences yet"})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"font-semibold mb-2",children:"Recent Events"}),s.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-1",children:[p.map(e=>s.jsxs("div",{className:"text-sm p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[s.jsx("span",{className:"px-2 py-0.5 text-xs rounded mr-2 "+("enter"===e.type?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e.type}),new Date(e.at).toLocaleString()," — ",e.fenceName]},e.id)),0===p.length&&s.jsx("div",{className:"text-gray-500 text-sm",children:"No events yet"})]})]}),s.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 rounded text-sm flex items-start",children:[s.jsx(d,{className:"h-5 w-5 text-amber-600 mr-2 mt-0.5"})," Background geofence checks run when the page is active. Mobile background service is planned."]})]})})};export{Geofencing as default};
