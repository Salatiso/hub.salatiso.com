import{G as e,j as s}from"./index-6c723d70.js";import{r as t,d as r,L as a}from"./vendor-d6555781.js";import{b as i,Q as n,D as l,A as o,I as c,z as d,R as m,V as x,J as u,U as g,Y as h,_ as p,H as y,B as b,a as v}from"./ui-eef567c7.js";import{f}from"./reciprocityApi-94144c00.js";import{u as j}from"./i18n-8b62e3c8.js";import"./firebase-fb364782.js";import"./firebase-fb825330.js";const UniversalTrustLayer=({userId:r,context:a="general"})=>{var c,d;const{guestData:m}=t.useContext(e),[x,u]=t.useState(0),[g,h]=t.useState("basic"),[p,y]=t.useState(!1),[b,v]=t.useState(!1),f=t.useCallback(()=>{var e,s,t,r;let i=0,n="basic";"enhanced"===m.verificationTier?(i+=40,n="enhanced"):"confirmed"===m.verificationTier?(i+=25,n="confirmed"):i+=10;const l=(null==(e=m.syncs)?void 0:e.filter(e=>e.completed))||[];i+=Math.min(5*l.length,30);const o=(null==(s=m.feedback)?void 0:s.filter(e=>e.rating>=4))||[];if(i+=Math.min(3*o.length,20),"general"!==a){const e=(null==(t=m.syncs)?void 0:t.filter(e=>e.context===a))||[];i+=Math.min(2*e.length,10)}const c=(null==(r=m.syncs)?void 0:r.filter(e=>Date.now()-e.createdAt<2592e6))||[];i+=Math.min(2*c.length,15),i=Math.min(Math.max(i,0),100),u(i),h(n),y("basic"!==m.verificationTier)},[a,m]);t.useEffect(()=>{f()},[f]);const getTrustColor=()=>x>=80?"text-green-600":x>=60?"text-blue-600":x>=40?"text-yellow-600":"text-red-600";return s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(i,{className:`h-6 w-6 ${getTrustColor()}`}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Trust Profile"})]}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium "+("enhanced"===g?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"confirmed"===g?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"),children:"enhanced"===g?"🏆 Elite Verified":"confirmed"===g?"✓ Verified":"🔒 Basic"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Universal Trust Score"}),s.jsxs("span",{className:`text-lg font-bold ${getTrustColor()}`,children:[x,"/100"]})]}),s.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:s.jsx("div",{className:"h-2 rounded-full transition-all duration-300 "+(x>=80?"bg-green-600":x>=60?"bg-blue-600":x>=40?"bg-yellow-600":"bg-red-600"),style:{width:`${x}%`}})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(null==(c=m.syncs)?void 0:c.length)||0}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Syncs Completed"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(null==(d=m.feedback)?void 0:d.length)||0}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Reviews"})]})]}),s.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[s.jsxs("button",{onClick:()=>v(!b),className:"flex items-center space-x-2 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:[s.jsx(n,{className:"h-4 w-4"}),s.jsx("span",{children:"Show Trust QR Code"})]}),b&&s.jsx("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-32 h-32 bg-white border-2 border-gray-300 mx-auto mb-2 flex items-center justify-center",children:s.jsx(n,{className:"h-16 w-16 text-gray-400"})}),s.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Scan to verify trust profile"}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Trust ID: ",r||"LS-"+Math.random().toString(36).substring(2,8).toUpperCase()]})]})})]}),s.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Trust Level Benefits"}),s.jsxs("div",{className:"space-y-1 text-xs text-gray-600 dark:text-gray-400",children:["enhanced"===g&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(l,{className:"h-3 w-3 text-green-600"}),s.jsx("span",{children:"Priority matching in all contexts"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(l,{className:"h-3 w-3 text-green-600"}),s.jsx("span",{children:"Advanced compatibility insights"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(l,{className:"h-3 w-3 text-green-600"}),s.jsx("span",{children:"Cross-platform reputation boost"})]})]}),"confirmed"===g&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(l,{className:"h-3 w-3 text-blue-600"}),s.jsx("span",{children:"Standard compatibility reports"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(l,{className:"h-3 w-3 text-blue-600"}),s.jsx("span",{children:"Verified profile badge"})]})]}),"basic"===g&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(o,{className:"h-3 w-3 text-yellow-600"}),s.jsx("span",{children:"Upgrade to unlock full features"})]})]})]})]})]})},QRTrustProfileScanner=({onScanSuccess:e,onScanError:r})=>{const[a,i]=t.useState(!1),[o,x]=t.useState(null),[u,g]=t.useState(null),h=t.useRef(null),p=t.useRef(null),stopScanning=()=>{var e;if(i(!1),null==(e=h.current)?void 0:e.srcObject){h.current.srcObject.getTracks().forEach(e=>e.stop())}},resetScanner=()=>{x(null),g(null),i(!1)};return s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(n,{className:"h-12 w-12 text-blue-600 dark:text-blue-400 mx-auto mb-2"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Trust Profile Scanner"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Scan a partner's trust QR code to verify their profile"})]}),s.jsxs("div",{className:"space-y-4",children:[!a&&!o&&!u&&s.jsx("div",{className:"text-center",children:s.jsxs("button",{onClick:async()=>{try{i(!0),g(null);const s=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});h.current&&(h.current.srcObject=s,h.current.play(),setTimeout(()=>{const s={userId:"LS-"+Math.random().toString(36).substring(2,8).toUpperCase(),trustScore:Math.floor(40*Math.random())+60,verificationTier:["basic","confirmed","enhanced"][Math.floor(3*Math.random())],lastVerified:Date.now(),context:"sync-verification"};x(s),null==e||e(s),stopScanning()},3e3))}catch(s){g("Camera access denied or not available"),i(!1),null==r||r(s)}},className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(c,{className:"h-5 w-5 mr-2"}),"Start Scanning"]})}),a&&s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("video",{ref:h,className:"w-64 h-64 border-2 border-blue-300 rounded-lg",playsInline:!0,muted:!0}),s.jsx("canvas",{ref:p,className:"hidden"}),s.jsx("div",{className:"absolute inset-0 border-2 border-blue-500 rounded-lg pointer-events-none",children:s.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:s.jsx("div",{className:"w-32 h-32 border-2 border-white rounded-lg opacity-50"})})})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-4",children:"Position QR code within the frame"}),s.jsx("button",{onClick:stopScanning,className:"mt-4 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Stop Scanning"})]}),o&&s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx(l,{className:"h-16 w-16 text-green-600 mx-auto mb-2"}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Trust Profile Verified"})]}),s.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Trust ID:"}),s.jsx("p",{className:"text-gray-900 dark:text-white font-mono",children:o.userId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Trust Score:"}),s.jsxs("p",{className:"font-bold "+(o.trustScore>=80?"text-green-600":o.trustScore>=60?"text-blue-600":"text-yellow-600"),children:[o.trustScore,"/100"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Tier:"}),s.jsx("p",{className:"font-medium "+("enhanced"===o.verificationTier?"text-green-600":"confirmed"===o.verificationTier?"text-blue-600":"text-gray-600"),children:o.verificationTier})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Last Verified:"}),s.jsx("p",{className:"text-gray-900 dark:text-white",children:new Date(o.lastVerified).toLocaleDateString()})]})]})}),s.jsxs("div",{className:"flex space-x-2 justify-center",children:[s.jsx("button",{onClick:()=>null==e?void 0:e(o),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Confirm & Continue"}),s.jsx("button",{onClick:resetScanner,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Scan Another"})]})]}),u&&s.jsxs("div",{className:"text-center",children:[s.jsx(d,{className:"h-16 w-16 text-red-600 mx-auto mb-2"}),s.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Scanning Error"}),s.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-4",children:u}),s.jsx("button",{onClick:resetScanner,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})]}),s.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(m,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[s.jsx("p",{className:"font-medium mb-1",children:"Security Note"}),s.jsx("p",{children:"QR codes contain encrypted trust data. Only scan codes from verified partners during sync setup."})]})]})})]})},ReciprocalRatingSystem=({syncId:r,partnerId:a,onRatingComplete:n})=>{const{guestData:l,setGuestData:o}=t.useContext(e),[c,d]=t.useState(0),[m,h]=t.useState(0),[p,y]=t.useState(""),[b,v]=t.useState({communication:0,reliability:0,compatibility:0,respect:0}),[f,j]=t.useState(!1),[N,k]=t.useState(!1);return N?s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx(x,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Thank You for Your Feedback!"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Your rating helps build trust in the LifeSync community"}),s.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:"Your feedback has been recorded and will contribute to both your trust score and your partner's."})})]})}):s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[s.jsx(i,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Rate Your Sync Experience"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Overall Experience"}),s.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(e=>s.jsx("button",{onClick:()=>d(e),onMouseEnter:()=>h(e),onMouseLeave:()=>h(0),className:"focus:outline-none",children:s.jsx(u,{className:`h-8 w-8 ${e<=(m||c)?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600"} transition-colors`})},e))}),(c>0||m>0)&&s.jsx("p",{className:"text-sm mt-2 "+(w=c||m,w>=4?"text-green-600":w>=3?"text-blue-600":w>=2?"text-yellow-600":"text-red-600"),children:(e=>e>=4.5?"Excellent":e>=4?"Very Good":e>=3?"Good":e>=2?"Fair":"Poor")(c||m)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Rate Specific Aspects"}),s.jsx("div",{className:"space-y-4",children:Object.entries({communication:"Communication",reliability:"Reliability",compatibility:"Compatibility",respect:"Respect & Trust"}).map(([e,t])=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 w-32",children:t}),s.jsx("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(t=>s.jsx("button",{onClick:()=>((e,s)=>{v(t=>({...t,[e]:s}))})(e,t),className:"w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs font-medium transition-colors "+(b[e]===t?"bg-blue-600 border-blue-600 text-white":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:border-blue-400"),children:t},t))})]},e))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Additional Feedback (Optional)"}),s.jsx("textarea",{value:p,onChange:e=>y(e.target.value),placeholder:"Share your experience or suggestions for improvement...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white resize-none",rows:3})]}),s.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(g,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[s.jsx("p",{className:"font-medium mb-1",children:"Trust Score Impact"}),s.jsx("p",{children:"Your rating will contribute to both your Universal Trust Score and your partner's score in the LifeSync ecosystem."})]})]})}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:async()=>{if(0===c)return;j(!0);const e=Object.values(b).reduce((e,s)=>e+s,0)/Object.values(b).length,s=Math.round((c+e)/2),t={id:Math.random().toString(36).substring(2,15),syncId:r,partnerId:a,overallRating:c,categoryRatings:b,compatibilityScore:s,feedback:p,timestamp:Date.now(),context:"sync-feedback"},i={...l,feedback:[...l.feedback||[],t]};o(i),k(!0),j(!1),null==n||n(t)},disabled:0===c||f,className:"px-6 py-2 rounded-lg font-medium transition-colors "+(0===c||f?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:f?"Submitting...":"Submit Rating"})})]})]});var w};function evaluateDisclosure({profile:e={},servicesRegistered:s=[],role:t}){var r,a,i,n;const l={name:!!(e.firstName&&e.firstName.trim()||(null==(r=e.providerRegistration)?void 0:r.fullName)&&e.providerRegistration.fullName.trim()||e.fullName),contact:!!(Array.isArray(e.emails)&&e.emails.some(e=>(e.address||"").trim())||Array.isArray(e.phones)&&e.phones.some(e=>(e.number||"").trim())||(null==(a=e.providerRegistration)?void 0:a.email)&&e.providerRegistration.email.trim()||(null==(i=e.providerRegistration)?void 0:i.contactNumber)&&e.providerRegistration.contactNumber.trim()||e.email||e.phone),photo:Array.isArray(e.images)?e.images.length>0:!!e.photoUrl,gps:!(!e.consentGPS||!e.gpsCoordinates),coverage:!!Array.isArray(null==(n=e.providerRegistration)?void 0:n.coverageAreas)&&e.providerRegistration.coverageAreas.length>0,services:!!Array.isArray(s)&&s.length>0,role:!(!t||!`${t}`.trim())},o=Object.entries(l).filter(([,e])=>e).map(([e])=>e),c=Object.keys(l).filter(e=>!o.includes(e));return{completionPercent:Math.round(o.length/Object.keys(l).length*100),present:o,missing:c}}function buildIncentives(e){const s={name:"Add your name to personalize your profile",contact:"Add an email or phone so partners can reach you",photo:"Add a profile photo to build trust",gps:"Enable GPS to unlock location-based safety features",coverage:"Add a coverage area (Province > City/Town) to serve your community",services:"Select the services you want to use or provide",role:"Choose your role (Driver, Passenger, Service Provider)"};return e.map(e=>s[e]).filter(Boolean)}const Sync=()=>{const{t:i}=j(),{syncId:o}=r(),{guestData:c,setGuestData:d}=t.useContext(e),[x,u]=t.useState(null),[N,k]=t.useState({}),[w,S]=t.useState(!1),[q,C]=t.useState(!1),[I,A]=t.useState(null),[R,T]=t.useState(null),[E,P]=t.useState({overlapPercent:null}),[D,M]=t.useState(null),[O,B]=t.useState(null),[V,$]=t.useState(""),[F,G]=t.useState("setup"),L={romance:{icon:y,color:"text-red-500"},business:{icon:b,color:"text-blue-500"},friendship:{icon:g,color:"text-green-500"},kinship:{icon:v,color:"text-purple-500"}},U=t.useCallback((e,s)=>{k(t=>({...t,[e]:s}))},[]),z={0:["Strongly support BEE initiatives","Support BEE but with conditions","Neutral on BEE","Oppose BEE initiatives","Strongly oppose BEE"],1:["Very important - qualifications are essential","Important but not the only factor","Somewhat important","Not very important","Experience matters more than qualifications"],2:["Actively promote women in leadership","Support equal opportunities","Neutral on gender issues","Traditional business approach","Focus on merit regardless of gender"],3:["Primarily merit-based hiring","Balance merit with diversity goals","Diversity considerations are important","Strong focus on transformation","Merit is the only consideration"],4:["Experience is much more valuable","Experience is more valuable than qualifications","Both are equally important","Qualifications are more valuable","Qualifications are much more valuable"],5:["Strong supporter of affirmative action","Support some affirmative action measures","Neutral on affirmative action","Oppose most affirmative action","Strongly oppose affirmative action"],6:["Transformation is a core business priority","Balance transformation with profitability","Business performance comes first","Transformation goals are secondary","Focus exclusively on business results"],7:["Actively invest in skills development","Support skills development programs","Neutral on skills development","Limited focus on skills development","Skills development is not a priority"],8:["Very important for business success","Somewhat important","Neutral on cultural diversity","Not very important","Cultural diversity is not a business priority"],9:["Always prioritize proven experience","Usually prioritize experience","Depends on the situation","Usually prioritize qualifications","Always prioritize formal qualifications"]},Q={0:["Outdoor activities and sports","Reading and intellectual pursuits","Social gatherings and parties","Creative hobbies and arts","Relaxing at home","Traveling and exploring","Volunteering and community work","Professional development"],1:["Witty and sarcastic","Light-hearted and playful","Dry and observational","Slapstick and physical comedy","Intellectual and wordplay-based","Self-deprecating","Dark or ironic","I don't have much of a sense of humor"],2:["Very important - I love deep discussions","Somewhat important","Neutral - depends on the context","Not very important","I prefer light conversation"],3:["Dinner parties with close friends","Outdoor adventures and hiking","Cultural events and performances","Sports events and games","Book clubs and intellectual discussions","Volunteering together","Traveling with friends","Quiet coffee meetups"],4:["Regular check-ins and calls","Social media and messaging","In-person meetups","Group activities and events","Shared experiences and adventures","I struggle with maintaining friendships","Quality over quantity","I have a small close-knit group"],5:["I'm always there when needed","I offer practical help and advice","I provide emotional support","I prefer to listen rather than give advice","I help by connecting them with resources","I offer financial assistance when possible","I help with professional networking","I prefer not to get involved in others' problems"],6:["Try to find common ground","Avoid confrontation when possible","Address issues directly but kindly","Get emotional and defensive","Seek mediation from others","End the friendship if it's serious","Give space and time to cool down","Compromise and find solutions"],7:["Pop and contemporary","Rock and alternative","Jazz and classical","Hip hop and R&B","Electronic and dance","Country and folk","World music and traditional","I don't listen to music much"],8:["Throw a party or celebration","Give thoughtful gifts","Write personal notes or cards","Plan special experiences","Share the moment publicly","Offer practical help or support","Create something meaningful","Keep it low-key and personal"],9:["Summer - warm and active","Autumn - colorful and cozy","Winter - peaceful and reflective","Spring - fresh and hopeful","I don't have a favorite season","All seasons have their appeal","Depends on my mood","I prefer consistent weather"]};t.useEffect(()=>{const e=c.syncs.find(e=>e.id===o);e&&u(e)},[o,c]);const Y=t.useCallback(e=>{if(A(e),C(!1),G("connected"),(null==e?void 0:e.userId)||(null==e?void 0:e.uid)){const s=e.uid||e.userId;$(s)}},[]),W=t.useCallback(e=>{C(!1)},[]),H=t.useCallback(e=>{G("completed");const s=c.syncs.map(s=>s.id===o?{...s,rating:e,completed:!0,completedAt:Date.now()}:s);d({...c,syncs:s})},[o,c]);t.useEffect(()=>{if(!w)return;const e=evaluateDisclosure({profile:c.profile||{},servicesRegistered:c.servicesRegistered||[],role:c.role});M(e);const s=R?evaluateDisclosure({profile:R.profile||R,servicesRegistered:R.servicesRegistered||R.services||[],role:R.role}):null;B(s),P(function(e,s){return s?{overlapPercent:Math.min(e.completionPercent,s.completionPercent)}:{overlapPercent:null}}(e,s))},[w,c.profile,c.servicesRegistered,c.role,R]),t.useEffect(()=>{let e=!1;return(async()=>{var s,t;if(!w)return;const r=((null==I?void 0:I.uid)||(null==I?void 0:I.userId)||"").toString().trim()||V.trim();if(r)try{const a=await f(r);if(e)return;T({...a.partnerVisible,role:null==(s=a.partnerEval)?void 0:s.role,services:null==(t=a.partnerVisible)?void 0:t.services}),a.partnerEval&&B(a.partnerEval),null!=a.overlapPercent&&P({overlapPercent:a.overlapPercent})}catch(a){}})(),()=>{e=!0}},[w,I,V]);if(!x)return s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(m,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:i("sync.notFound.title")}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:i("sync.notFound.description")}),s.jsx(a,{to:"/solo",className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors",children:i("sync.notFound.startNew")})]})});const J=L[x.context],_=J.icon,K=(Z=x.context,{romance:[i("sync.questions.romance.1"),i("sync.questions.romance.2"),i("sync.questions.romance.3"),i("sync.questions.romance.4"),i("sync.questions.romance.5"),i("sync.questions.romance.6"),i("sync.questions.romance.7"),i("sync.questions.romance.8"),i("sync.questions.romance.9"),i("sync.questions.romance.10")],business:[i("sync.questions.business.1"),i("sync.questions.business.2"),i("sync.questions.business.3"),i("sync.questions.business.4"),i("sync.questions.business.5"),i("sync.questions.business.6"),i("sync.questions.business.7"),i("sync.questions.business.8"),i("sync.questions.business.9"),i("sync.questions.business.10")],friendship:[i("sync.questions.friendship.1"),i("sync.questions.friendship.2"),i("sync.questions.friendship.3"),i("sync.questions.friendship.4"),i("sync.questions.friendship.5"),i("sync.questions.friendship.6"),i("sync.questions.friendship.7"),i("sync.questions.friendship.8"),i("sync.questions.friendship.9"),i("sync.questions.friendship.10")],kinship:[i("sync.questions.kinship.1"),i("sync.questions.kinship.2"),i("sync.questions.kinship.3"),i("sync.questions.kinship.4"),i("sync.questions.kinship.5"),i("sync.questions.kinship.6"),i("sync.questions.kinship.7"),i("sync.questions.kinship.8"),i("sync.questions.kinship.9"),i("sync.questions.kinship.10")]}[Z]||[]);var Z;const X={romance:"likert",business:"choice",friendship:"choice",kinship:"likert"}[x.context]||"likert";return s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx(_,{className:`h-12 w-12 ${J.color} mx-auto mb-4`}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:J.title}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:i("sync.header.syncId",{id:o})})]}),w?s.jsxs("div",{children:[s.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(l,{className:"h-5 w-5 text-green-500 mr-2"}),s.jsx("span",{className:"text-green-800 dark:text-green-200 font-medium",children:i("sync.connected.message")})]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsx(UniversalTrustLayer,{userId:c.id,context:x.context}),s.jsx("div",{children:q?s.jsx(QRTrustProfileScanner,{onScanSuccess:Y,onScanError:W}):s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx(n,{className:"h-12 w-12 text-blue-600 dark:text-blue-400 mx-auto mb-2"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:i("sync.trust.title")}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:i("sync.trust.description")}),s.jsxs("button",{onClick:()=>C(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(n,{className:"h-5 w-5 inline mr-2"}),i("sync.trust.startScan")]})]})})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Reciprocity & Visibility"}),s.jsx(p,{className:"h-5 w-5 text-primary-600"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"You see what you share. Completing more profile items increases mutual visibility."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/40",children:[s.jsx("div",{className:"text-xs uppercase text-gray-500 mb-1",children:"Your completion"}),s.jsxs("div",{className:"text-2xl font-bold",children:[(null==D?void 0:D.completionPercent)??0,"%"]}),D&&D.missing.length>0&&s.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-300",children:["Missing: ",D.missing.join(", ")]})]}),s.jsxs("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/40",children:[s.jsx("div",{className:"text-xs uppercase text-gray-500 mb-1",children:"Partner completion"}),s.jsx("div",{className:"text-2xl font-bold",children:O?`${O.completionPercent}%`:"—"}),O&&O.missing.length>0&&s.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-300",children:["Missing: ",O.missing.join(", ")]})]}),s.jsxs("div",{className:"p-4 rounded-lg bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-800",children:[s.jsx("div",{className:"text-xs uppercase text-primary-700 dark:text-primary-300 mb-1",children:"Mutual visibility"}),s.jsx("div",{className:"text-2xl font-bold text-primary-800 dark:text-primary-200",children:null!=E.overlapPercent?`${E.overlapPercent}%`:"TBD"}),s.jsx("div",{className:"mt-2 text-xs text-primary-800/80 dark:text-primary-300/90",children:null!=E.overlapPercent?"Based on lower of the two completion scores":"Connect and share to determine overlap"})]})]}),s.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[s.jsx("input",{type:"text",placeholder:"Enter partner UID (optional)",value:V,onChange:e=>$(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm w-full md:w-80"}),s.jsx("button",{onClick:()=>$(V.trim()),className:"px-3 py-2 rounded bg-primary-600 text-white text-sm",children:"Fetch"})]}),D&&D.missing.length>0&&s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"text-sm font-medium mb-1",children:"Boost your visibility"}),s.jsx("ul",{className:"list-disc pl-6 text-sm text-gray-700 dark:text-gray-300",children:buildIncentives(D.missing).map(e=>s.jsx("li",{children:e},e))}),s.jsx("div",{className:"mt-3",children:s.jsx(a,{to:"/onboarding",className:"inline-block px-3 py-2 rounded bg-primary-600 text-white text-sm",children:"Quickly complete profile"})})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:i("sync.questions.title")}),K.map((e,t)=>{return s.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[s.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-3",children:e}),s.jsx("div",{className:"space-y-2",children:(r=t,"likert"===X?[i("sync.answers.stronglyAgree"),i("sync.answers.agree"),i("sync.answers.neutral"),i("sync.answers.disagree"),i("sync.answers.stronglyDisagree")]:"business"===x.context?z[r]||[]:"friendship"===x.context&&Q[r]||[]).map((e,r)=>s.jsx("button",{onClick:()=>U(t,r+1),className:"w-full text-left p-3 rounded border transition-colors "+(N[t]===r+1?"border-primary-500 bg-primary-50 dark:bg-primary-900 text-primary-700 dark:text-primary-300":"border-gray-200 dark:border-gray-600 hover:border-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900"),children:e},e))})]},t);var r})]}),Object.keys(N).length===K.length&&s.jsx("div",{className:"mt-8 text-center",children:s.jsxs(a,{to:`/report/${(()=>{const e=Math.random().toString(36).substring(2,15),s=Math.floor(40*Math.random())+60,t={id:e,syncId:o,context:x.context,compatibility:s,yourAnswers:c.questionnaires[x.context]||{},partnerAnswers:N,createdAt:Date.now()},r={...c,reports:[...c.reports||[],t]};return d(r),e})()}`,className:"bg-primary-600 text-white px-8 py-3 rounded-lg hover:bg-primary-700 transition-colors inline-flex items-center space-x-2",children:[s.jsx("span",{children:i("sync.report.generate")}),s.jsx(l,{className:"h-5 w-5"})]})})]}):s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-6 mb-6",children:[s.jsx(h,{className:"h-8 w-8 text-primary-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:i("sync.waiting.title")}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:i("sync.waiting.description")}),s.jsxs("div",{className:"flex items-center space-x-2 justify-center",children:[s.jsx("input",{type:"text",value:`${window.location.origin}/sync/${o}`,readOnly:!0,className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm"}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(`${window.location.origin}/sync/${o}`),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors text-sm",children:i("sync.waiting.copy")})]})]}),s.jsx("button",{onClick:()=>S(!0),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors",children:i("sync.waiting.simulate")})]}),"completed"===F&&s.jsx("div",{className:"mt-8",children:s.jsx(ReciprocalRatingSystem,{syncId:o,partnerId:null==I?void 0:I.userId,onRatingComplete:H})})]})})})};export{Sync as default};
